### Ambient Occlusion [SSAO]

环境光遮挡（Ambient Occlusion，AO）是当场景被均匀的散射球形光源包围时引起的照明。可以将场景想象成被一个巨大的球体围绕，该球体从其表面均匀地发出光。AO捕获低频照明。它不会捕获锐利的阴影、漫反射（Diffuse）或高光（Specular）照明。因此，AO通常与漫反射和高光照明结合使用以创建完整的照明解决方案。

Ambient Occlusion工具会在3D渲染的场景中生成全局照明效果作为后期效果。它可以快速近似昂贵的光线跟踪的全局照明。作为后期效果，它会像Shader、Texture和VolumeFog工具一样暴露类似的锯齿问题。 因此，在某些情况下可能会出现伪影。

#### Usage 用法

AO工具很少能立即使用，而是需要进行一些调整。设置过程包括调整KernelRadius和NumberOfSamples来获得所需的效果。

KernelRadius取决于场景的自然“比例”。最初看起来根本没有AO。此时，KernelRadius太小或太大，必须找到可以工作的值。

#### Inputs 输入

- **图像 （必需的）：**需要RGBA、Z深度和法线。
- **场景（必需的）：**渲染图像的场景或3D相机。

如果未提供这些工具中的任何一个，则该工具将失败并出现带描述的错误。

#### Controls 控件

![SSAO_Controls](images\SSAO_Controls.png)

##### Output Mode 输出模式

- **颜色：**应用了Ambient Occlusion的传入图像
- **AO：**将Ambient Occlusion输出为灰度图像。

白色对应于颜色通道中应明亮的区域，而黑色对应于应较暗的区域。这使你可以通过组合单独的环境/漫反射/高光通道来创建照明方程。将AO作为单独的缓冲区可让创作自由地以各种方式组合通道。

##### Kernel Type 内核类型

为了确定AO，光线从被着色的表面上的一点向外投射到一个大的封闭球体上。

未被遮挡的光线（即到达球体的光线）的数量决定了AO的因子。

- **Hemisphere 半球：**光线朝向朝向法线表面的半球投射。该选项比Sphere更真实，除非有充分的理由，否则应使用此选项。平面将获得100％的环境强度，而其他部分将变暗。
- **Sphere 球：**光线投射到以着色点为中心的球体。提供此选项可产生风格效果。平面将接收50％的环境强度，而其他部分将变暗或变亮。

##### Number of Samples 样本数

增加样本数量，直到AO传递中的伪影消失为止。较高的值可以产生更好的结果，但也会增加渲染时间。

##### Kernel Radius 内核半径

Kernel Radius控制3D空间中滤镜内核的大小。对于每个像素，它控制一个对象在3D空间中搜索遮挡物的距离。滤镜内核很可能是挑剔的，可能需要针对每个单独的场景进行手动调整。

如果做得太小，可能会错过附近的遮挡器。如果做得太大，AO的质量将会降低，并且需要显着增加样本数量才能恢复质量。

该值取决于场景的Z深度。这意味着在场景中具有巨大的Z值时，内核大小也需要很大。Z值很小时，较小的内核大小（例如0.1）就足够了。

##### Lift/Gamma/Tint 抬升/伽马/色泽

用于调整AO的艺术效果。

##### Use OpenCL 使用OpenCL

![SSAO_UseOpenCL1](images\SSAO_UseOpenCL1.png)

![SSAO_UseOpenCL2](images\SSAO_UseOpenCL2.png)

> **提示** 将多个AO通道与不同的内核半径相结合可以产生更好的效果。


> #### **已知问题**
>
> <b>透明/半透明：</b>AO被设计用于不透明的对象。问题将有两种：带有透明接收器的问题和带有透明遮挡器的问题。您可以通过将透明/半透明对象拆分为单独的场景并仅对不透明对象计算AO来解决这些问题。
>
> <b>粒子：</b>除非粒子是不透明的实体，否则不要在粒子上使用AO。这又只是透明度问题。抗锯齿的边缘（另一种透明形式）也将导致AO问题。你对此无能为力。
>
> <b>超级采样：</b>参考抗锯齿边缘。为了使它起作用，需要在大图像中计算AO，然后再将其下采样到最终图像。
>
> <b>视图依赖关系：</b>AO方法在视图空间中工作，结果取决于视图。这是该技术本身的局限性。这意味着变暗的数量可能会根据视图位置而有所不同，而实际上它应该是恒定的。如果对象上的某个点的AO为0.5，则移动相机可能会将其更改为0.4。
>
> <b>AO的烘焙：</b>UV渲染器可用于将AO烘焙到模型的纹理中。